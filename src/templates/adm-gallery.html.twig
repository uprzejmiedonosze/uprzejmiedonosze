{% set leftButton = 'menu' %}
{% set rightButton = 'menuStart' %}

{% extends "base.html.twig" %}

{% block main %}
<div class="tumblr_posts">
{% for app in applications %}
    <div class="galleryItem" id="{{app.id}}">
        <img class="lazyload" data-src="{{ app.contextImage.thumb }}" width="600" height="400">
        <p class="desc">
            <b>{{ app.number }}</b> {{ app.carInfo.plateId }}{% if app.getRecydywa > 1 %}<sup>(recydywista)</sup>{% endif %}
            {{ app.address.city}} â€“ {{ app.getCategory.getShort }}
        </p>
        <div class="actions">
            <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
                <label for="OK{{ app.id }}">OK</label>
                <input type="radio" name="moderateApp" value="1" id="OK{{ app.id }}"
                    onclick="_moderateApp('{{ app.id }}', true)" />
                <label for="Out{{ app.id }}">Out</label>
                <input type="radio" name="moderateApp" value="0" id="Out{{ app.id }}"
                    onclick="_moderateApp('{{ app.id }}', false)" />
            </fieldset>
        </div>

    </div>
{% endfor %}
</div>
    <script>
        function _moderateApp(appId, decision){
            $.post('/api/api.html', {action: 'moderateApp', id: appId, decision: decision
            }).done(function() {
                $('#' + appId).removeClass('decisiontrue decisionfalse').addClass('decision' + decision);
            }).fail(function(e){
                console.log(e);
                $.mobile.loading("show",
                    { text: e.statusText, textVisible: true, textonly: true } );
                return false;
            });
        }
    </script>
{% endblock %}
