<?PHP
require_once(__DIR__ . '/../inc/include.php');

checkIfLogged();

if(isset($_SESSION['newAppId'])){ // edit mode
    $application = $storage->getApplication($_SESSION['newAppId']);
}else{ // new application mode
    $application = new Application();
    $storage->saveApplication($application);
	$_SESSION['newAppId'] = $application->id;
}

generate('nowe-zgloszenie.html.twig', 
    [
        'head' =>
        [
            'title' => "Nowe zgłoszenie",
            'shortTitle' => "Nowe zgłoszenie",
            'mainClass' => 'new-application',
            'mapsInitFunc' => 'initAutocompleteOnNewApplication'
        ],
        'config' =>
        [
            'auth' => true,
        ],
        'categories' => CATEGORIES,
        'categoriesMatrix' => CATEGORIES_MATRIX,
        'app' => $application
    ]
);

?>
