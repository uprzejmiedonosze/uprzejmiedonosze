<? 
require_once(__DIR__ . '/../inc/include.php');

$applicationId = $_GET["id"];
$application = $storage->getApplication($applicationId);

$isAppOwnerOrAdmin = false;
if(isLoggedIn()){
    $isAppOwnerOrAdmin = ($storage->getCurrentUser()->isAdmin()) || (getCurrentUserEmail() == $application->user->email);
}

generate('zgloszenie.html.twig', 
    [
        'head' =>
        [
            'title' => "Zgłoszenie {$application->number} z dnia {$application->getDate()}",
            'shortTitle' => "Zgłoszenie {$application->number}",
            'image' => $application->contextImage->thumb,
            'description' => "Samochód o nr rejestracyjnym {$application->carInfo->plateId} " .
                "pod adresem {$application->address->address}. {$application->getCategory()[1]}"
        ],
        'config' =>
        [
            'appDetails' => true,
            'isAppOwnerOrAdmin' => $isAppOwnerOrAdmin
        ],
        'app' => $application,
        'statuses' => STATUSES
    ]
);
?>
