<!DOCTYPE html>
<html lang="pl">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<title>Uprzejmie donoszę</title>
		<link href="css/font-awesome.min.css" rel="stylesheet" type="text/css">
		<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
		<link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
		<link href="css/freelancer.css" rel="stylesheet" type="text/css">

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body class="index">
		<div class="container-fluid">
			<form>
				<div class="form-group">
					<input type="file" accept="image/*" capture="camera" class="form-control" id="pic1" aria-describedby="pic1Help"/>
					<small id="pic1Help" class="form-text text-muted">Zrób zdjęcie prezentujące kontekst zgłoszenia</small>
				</div>
				<div class="form-group floating-label-form-group controls">
					<input type="text" class="form-control" id="address" aria-describedby="addressHelp" placeholder="Miejsce zgłoszenia">
					<small id="addressHelp" class="form-text text-muted">Podaj miejsce zgłoszenia</small>
				</div>
				<div class="form-group">
					<input type="text" class="form-control" id="plateid" aria-describedby="plateidHelp" placeholder="Numer rejestracyjny">
					<small id="plateidHelp" class="form-text text-muted">Podaj numer rejestracyjny pojazdu który dokonał naruszenia</small>
				</div>
				<div class="form-group">
					<select class="form-control" id="category">
						<option>Zastawienie chodnika (mniej niż 1.5m)</option>
						<option>Mniej niż 15 m od przystanku</option>
						<option>Mniej niż 10m od skrzyżowania</option>
						<option>Mniej niż 10m od przejścia dla pieszych</option>
						<option>Parkowanie na trawniku/wparku</option>
						<option>Parkowanie za barierkami</option>
						<option>Parkowanie z dala od krawędzi jezdni</option>
						<option>Niszczenie chodnika</option>
						<option>Inne</option>
					</select>
				</div>
				<div class="form-group">
					<input type="text" class="form-control" id="name" aria-describedby="nameHelp" placeholder="Twoje imię i nazwisko">
					<small id="nameHelp" class="form-text text-muted">Pamiętaj, że nie możesz dokonać anonimowego zgłoszenia</small>
				</div>
				<div class="form-group">
					<div class="input-group mb-2 mr-sm-2 mb-sm-0">
						<div class="input-group-addon">@</div>
						<input type="email" class="form-control form-control-danger" id="email" aria-describedby="emailHelp" placeholder="Twój email">
					</div>
					<small id="emailHelp" class="form-text text-muted">Podaj swój email</small>
				</div>
				<div class="form-group">
					<input type="tel" class="form-control" id="msisdn" aria-describedby="msisdnHelp" placeholder="Twój numer telefonu">
					<small id="msisdnHelp" class="form-text text-muted">Podaj swój numer kontaktowy</small>
				</div>
				<div class="form-group">
					<input type="datetime-local" class="form-control-static" id="date" aria-describedby="dateHelp" placeholder="Data i czas zgłoszenia">
					<small id="dateHelp" class="form-text text-muted">Formularz umożliwia wyłącznie wprowadzenie aktualnego czasu</small>
				</div>
				<button type="submit" class="btn btn-primary">Submit</button>
			</form>
		</div>
		<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
		<script>
if (window.File && window.FileReader && window.FormData) {
	var $inputField = $('#pic1');

	$inputField.on('change', function (e) {
		var file = e.target.files[0];

		if (file) {
			if (/^image\//i.test(file.type)) {
				readFile(file);
			} else {
				alert('Not a valid image!');
			}
		}
	});
} else {
	alert("File upload is not supported!");
}

function readFile(file) {
	var reader = new FileReader();

	reader.onloadend = function () {
		processFile(reader.result, file.type);
	}

	reader.onerror = function () {
		alert('There was an error reading the file!');
	}

	reader.readAsDataURL(file);
}
function processFile(dataURL, fileType) {
	var maxWidth = 800;
	var maxHeight = 800;

	var image = new Image();
	image.src = dataURL;

	image.onload = function () {
		var width = image.width;
		var height = image.height;
		var shouldResize = (width > maxWidth) || (height > maxHeight);

		if (!shouldResize) {
			sendFile(dataURL);
			return;
		}

		var newWidth;
		var newHeight;

		if (width > height) {
			newHeight = height * (maxWidth / width);
			newWidth = maxWidth;
		} else {
			newWidth = width * (maxHeight / height);
			newHeight = maxHeight;
		}

		var canvas = document.createElement('canvas');

		canvas.width = newWidth;
		canvas.height = newHeight;

		var context = canvas.getContext('2d');

		context.drawImage(this, 0, 0, newWidth, newHeight);

		dataURL = canvas.toDataURL(fileType);

		sendFile(dataURL);
	};

	image.onerror = function () {
		alert('There was an error processing your file!');
	};
}

function sendFile(fileData) {
	var formData = new FormData();

	formData.append('imageData', fileData);

	$.post('url', {
		data: formData,
		contentType: false,
		processData: false,
		success: function (data) {
			if (data.success) {
				alert('Your file was successfully uploaded!');
			} else {
				alert('There was an error uploading your file!');
			}
		},
		error: function (data) {
			alert('There was an error uploading your file!');
		}
	});
}
		</script>
	</body>
</html>
